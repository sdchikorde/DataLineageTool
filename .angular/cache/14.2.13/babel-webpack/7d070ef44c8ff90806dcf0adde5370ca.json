{"ast":null,"code":"/*\r\nDocumentation by Siddharth Chikorde\r\n\r\nIn order to add any new type of entity in the tool, you need to make following changes:\r\n1. Array of those objects\r\ne.g. operations = [{...},..]\r\n2. Define look and feel for new object type in following maps\r\nnodeColorMap, nodeIconMap, nodeTypeVisibilityMap, nodeSizeMap\r\n3. Define id based map object\r\ne.g. operationsMap = {};\r\n4. Define your type name in function commons.getNodeTypeById(id: string)\r\n5. Refer your map object in function getNodeById\r\n6. Define link behaviour for this new object type with other object types in function addLinkForGraph\r\n7. Also add UI elements for this entity (visibility marker)\r\n*/\nimport { ElementRef } from \"@angular/core\";\nimport { MatDialog } from '@angular/material/dialog';\nimport * as d3 from \"d3\";\nimport \"d3-selection-multi\";\nimport \"d3-force\";\nimport \"d3-zoom\";\nimport { DialogComponentComponent } from './dialog-component/dialog-component.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./commons.service\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"@angular/material/snack-bar\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/material/toolbar\";\nimport * as i6 from \"@angular/material/icon\";\nimport * as i7 from \"@angular/material/slide-toggle\";\nimport * as i8 from \"@angular/material/tooltip\";\nimport * as i9 from \"@angular/material/divider\";\nimport * as i10 from \"@angular/material/button\";\nimport * as i11 from \"@angular/flex-layout/extended\";\nimport * as i12 from \"./dropdown/dropdown.component\";\nconst _c0 = [\"svgElement\"];\nconst _c1 = function (a0) {\n  return {\n    disabled: a0\n  };\n};\nconst _c2 = function (a0) {\n  return {\n    \"padding-right\": a0\n  };\n};\nfunction AppComponent_div_5_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 24)(1, \"span\", 25);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_5_div_14_Template_span_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const nodeid_r6 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.nodeIdMap[nodeid_r6] ? ctx_r7.removeNode(nodeid_r6) : ctx_r7.addNodeForGraph(nodeid_r6, false));\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 26);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_5_div_14_Template_span_click_3_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const nodeid_r6 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.addNodeForGraph(nodeid_r6));\n    });\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const nodeid_r6 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(5, _c1, !ctx_r4.nodeTypeVisibilityMap[ctx_r4.commons.getNodeTypeById(nodeid_r6)]));\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"matTooltip\", \"\", ctx_r4.nodeIdMap[nodeid_r6] ? \"Remove\" : \"Add\", \" node\");\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(7, _c2, ctx_r4.nodeIdMap[nodeid_r6] ? \"0px\" : \"2px\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r4.nodeIdMap[nodeid_r6] ? \"\\u2714\\uFE0F\" : \"\\u00A0\\u00A0\\u00A0\\u00A0\\u00A0\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r4.getNodeById(nodeid_r6).name, \" \");\n  }\n}\nfunction AppComponent_div_5_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 24)(1, \"span\", 25);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_5_div_25_Template_span_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const nodeid_r10 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r11.nodeIdMap[nodeid_r10] ? ctx_r11.removeNode(nodeid_r10) : ctx_r11.addNodeForGraph(nodeid_r10, false));\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 26);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_5_div_25_Template_span_click_3_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const nodeid_r10 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r13.addNodeForGraph(nodeid_r10, true));\n    });\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const nodeid_r10 = ctx.$implicit;\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(5, _c1, !ctx_r5.nodeTypeVisibilityMap[ctx_r5.commons.getNodeTypeById(nodeid_r10)]));\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"matTooltip\", \"\", ctx_r5.nodeIdMap[nodeid_r10] ? \"Remove\" : \"Add\", \" node\");\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(7, _c2, ctx_r5.nodeIdMap[nodeid_r10] ? \"0px\" : \"2px\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r5.nodeIdMap[nodeid_r10] ? \"\\u2714\\uFE0F\" : \"\\u00A0\\u00A0\\u00A0\\u00A0\\u00A0\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r5.getNodeById(nodeid_r10).name, \" \");\n  }\n}\nconst _c3 = function (a0) {\n  return {\n    \"visibility\": a0\n  };\n};\nconst _c4 = function (a0) {\n  return {\n    invisible: a0\n  };\n};\nfunction AppComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"center\", 9)(2, \"div\", 10)(3, \"div\", 11)(4, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_5_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.addAllBackwardNodes(ctx_r14.selectedNodeId, true));\n    });\n    i0.ɵɵtext(5, \"\\u25C0\\u25C0\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"span\", 13);\n    i0.ɵɵtext(7, \"\\u00A0\\u00A0Total Bwd Lineage\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_5_Template_button_click_8_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.addAllBackwardNodes(ctx_r16.selectedNodeId, false));\n    });\n    i0.ɵɵtext(9, \"\\u25C0 \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 15)(11, \"span\", 16);\n    i0.ɵɵtext(12, \"\\u00A0\\u00A0Prev Level Lineage\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"div\", 17);\n    i0.ɵɵtemplate(14, AppComponent_div_5_div_14_Template, 5, 9, \"div\", 18);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(15, \"h3\", 19);\n    i0.ɵɵtext(16);\n    i0.ɵɵpipe(17, \"titlecase\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"mat-icon\", 20);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_5_Template_mat_icon_click_18_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.openDialog(ctx_r17.getNodeById(ctx_r17.selectedNodeId), ctx_r17.masterMap));\n    });\n    i0.ɵɵtext(19, \"info\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"div\", 11)(21, \"div\", 15)(22, \"span\", 16);\n    i0.ɵɵtext(23, \"Next Level Lineage\\u00A0\\u00A0\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"div\", 17);\n    i0.ɵɵtemplate(25, AppComponent_div_5_div_25_Template, 5, 9, \"div\", 18);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(26, \"button\", 21);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_5_Template_button_click_26_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.addAllForwardNodes(ctx_r18.selectedNodeId, false));\n    });\n    i0.ɵɵtext(27, \"\\u25B6\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(28, \"span\", 22);\n    i0.ɵɵtext(29, \"Total Fwd Lineage\\u00A0\\u00A0\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(30, \"button\", 23);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_5_Template_button_click_30_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r19 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r19.addAllForwardNodes(ctx_r19.selectedNodeId, true));\n    });\n    i0.ɵɵtext(31, \"\\u25B6\\u25B6\");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(10, _c3, ctx_r0.getNodeById(ctx_r0.selectedNodeId).backwardnodes.length > 0 ? \"visible\" : \"hidden\"));\n    i0.ɵɵadvance(10);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(12, _c4, !ctx_r0.getNodeById(ctx_r0.selectedNodeId).backwardnodes.length > 0));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.getNodeById(ctx_r0.selectedNodeId).backwardnodes);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r0.getNodeById(ctx_r0.selectedNodeId).name, \" (\", i0.ɵɵpipeBind1(17, 8, ctx_r0.commons.getNodeTypeById(ctx_r0.selectedNodeId)), \")\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(14, _c3, ctx_r0.getNodeById(ctx_r0.selectedNodeId).forwardnodes.length > 0 ? \"visible\" : \"hidden\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(16, _c4, !ctx_r0.getNodeById(ctx_r0.selectedNodeId).forwardnodes.length > 0));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.getNodeById(ctx_r0.selectedNodeId).forwardnodes);\n  }\n}\nfunction AppComponent_button_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 27);\n    i0.ɵɵlistener(\"click\", function AppComponent_button_10_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r20 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r20.clearAll());\n    });\n    i0.ɵɵtext(1, \"Clear Nodes\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 28)(1, \"span\", 29);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \"\\u00A0\\u00A0\");\n    i0.ɵɵelementStart(4, \"span\");\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"titlecase\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"mat-slide-toggle\", 30);\n    i0.ɵɵlistener(\"change\", function AppComponent_div_14_Template_mat_slide_toggle_change_7_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r24);\n      const symbol_r22 = restoredCtx.$implicit;\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.toggleNodeVisibility(symbol_r22.key));\n    });\n    i0.ɵɵpipe(8, \"titlecase\");\n    i0.ɵɵtext(9, \" \\u00A0 \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const symbol_r22 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(symbol_r22.value);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(6, 6, symbol_r22.key));\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate2(\"matTooltip\", \"\", ctx_r3.nodeTypeVisibilityMap[symbol_r22.key] ? \"Disable\" : \"Enable\", \" visibility for nodes of type \", i0.ɵɵpipeBind1(8, 8, symbol_r22.key), \"\");\n    i0.ɵɵproperty(\"color\", \"primary\")(\"checked\", ctx_r3.nodeTypeVisibilityMap[symbol_r22.key]);\n  }\n}\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor(hostElement, commons, dialog, snack) {\n      this.hostElement = hostElement;\n      this.commons = commons;\n      this.dialog = dialog;\n      this.snack = snack;\n      //pokemonControl = new FormControl();\n      this.pokemonGroups = [{\n        name: 'Grass',\n        pokemon: [{\n          value: 'bulbasaur-0',\n          viewValue: 'Bulbasaur'\n        }, {\n          value: 'oddish-1',\n          viewValue: 'Oddish'\n        }, {\n          value: 'bellsprout-2',\n          viewValue: 'Bellsprout'\n        }]\n      }, {\n        name: 'Water',\n        pokemon: [{\n          value: 'squirtle-3',\n          viewValue: 'Squirtle'\n        }, {\n          value: 'psyduck-4',\n          viewValue: 'Psyduck'\n        }, {\n          value: 'horsea-5',\n          viewValue: 'Horsea'\n        }]\n      }, {\n        name: 'Fire',\n        disabled: true,\n        pokemon: [{\n          value: 'charmander-6',\n          viewValue: 'Charmander'\n        }, {\n          value: 'vulpix-7',\n          viewValue: 'Vulpix'\n        }, {\n          value: 'flareon-8',\n          viewValue: 'Flareon'\n        }]\n      }, {\n        name: 'Psychic',\n        pokemon: [{\n          value: 'mew-9',\n          viewValue: 'Mew'\n        }, {\n          value: 'mewtwo-10',\n          viewValue: 'Mewtwo'\n        }]\n      }];\n      this.showImage = \"data:image/png;base64,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\";\n      this.hideImage = \"data:image/png;base64,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\";\n      this.name = \"DLT\";\n      this.index = 10;\n      this.selectedNodeId = \"\";\n      this.itemList = [];\n      this.selectedItems = [];\n      this.settings = {};\n      ///////////////////////////////My Data and Functions/////////////////////////////////////////\n      this.currentSystem = \"sys000000\";\n      this.masterMap = {};\n      this.defaultNodeColor = \"black\";\n      this.defaultNodeSize = 10;\n      this.nodeColorMap = {\n        system: \"red\",\n        feed: \"blue\",\n        table: \"orage\",\n        operation: \"yellow\",\n        view: \"green\"\n      };\n      this.nodeIconMap = {\n        system: \"🏛️\",\n        feed: \"🧾\",\n        table: \"𝄜\",\n        operation: \"⚙️\",\n        view: \"👁\"\n      };\n      this.nodeTypeVisibilityMap = {\n        system: true,\n        feed: true,\n        table: true,\n        operation: true,\n        view: true\n      };\n      this.nodeSizeMap = {\n        system: 12,\n        feed: 12,\n        table: 12,\n        operation: 12,\n        view: 12\n      };\n      this.nodeIdMap = {};\n      this.systemsMap = {};\n      this.feedsMap = {};\n      this.tablesMap = {};\n      this.operationsMap = {};\n      this.viewsMap = {};\n      this.linkCount = 0;\n      ///////////////////////////////GRAPH RELATED FUNCATIONALITY START////////////////////////////\n      this.nodes = [\n        /*{\"id\": 1, \"name\": \"server 1\"},\r\n        {\"id\": 2, \"name\": \"server 2\"},\r\n        {\"id\": 3, \"name\": \"server 3\"},\r\n        {\"id\": 4, \"name\": \"server 4\"},\r\n        {\"id\": 5, \"name\": \"server 5\"},\r\n        {\"id\": 6, \"name\": \"server 6\"},\r\n        {\"id\": 7, \"name\": \"server 7\"},\r\n        {\"id\": 8, \"name\": \"server 8\"},\r\n        {\"id\": 9, \"name\": \"server 9\"}*/\n      ];\n      this.links = [\n        /*{source: 1, target: 2},\r\n        {source: 1, target: 3},\r\n        {source: 1, target: 4},\r\n        {source: 2, target: 5},\r\n        {source: 2, target: 6},\r\n        {source: 3, target: 7},\r\n        {source: 5, target: 8},\r\n        {source: 6, target: 9}*/\n      ];\n      this.zoom_handler = d3.zoom().scaleExtent([0.4, 2.5]).on(\"zoom\", e => {\n        this.zoom_actions(e);\n      }).filter(e => {\n        if (e.type == 'wheel') {\n          if (e.altKey || e.shiftKey) {\n            return true;\n          }\n        } else {\n          return true;\n        }\n        return false;\n      });\n      this.systems = commons.systems;\n      this.tables = commons.tables;\n      this.views = commons.views;\n      this.operations = commons.operations;\n      this.feeds = commons.feeds;\n      this.snack.open(\"Concept & Development by Siddharth Chikorde\", \"\", {\n        duration: 6000\n      });\n    }\n    nodeSelectionUpdate(e) {\n      if (e.selected) {\n        this.addNodeForGraph(e.id, false);\n      } else {\n        this.removeNode(e.id, false);\n      }\n    }\n    printnodelink() {\n      console.log(this.link, this.node);\n    }\n    parse(obj) {\n      return JSON.stringify(obj);\n    }\n    setSelectedNodeId(id) {\n      this.selectedNodeId = id;\n    }\n    onItemSelect(item) {\n      console.log(item);\n      console.log(this.selectedItems);\n    }\n    OnItemDeSelect(item) {\n      console.log(item);\n      console.log(this.selectedItems);\n    }\n    onSelectAll(items) {\n      console.log(items);\n    }\n    onDeSelectAll(items) {\n      console.log(items);\n    }\n    ngOnInit() {\n      this.itemList = [{\n        \"id\": 1,\n        \"itemName\": \"India\",\n        \"category\": \"asia\"\n      }, {\n        \"id\": 2,\n        \"itemName\": \"Singapore\",\n        \"category\": \"asia pacific\"\n      }, {\n        \"id\": 3,\n        \"itemName\": \"Germany\",\n        \"category\": \"Europe\"\n      }, {\n        \"id\": 4,\n        \"itemName\": \"France\",\n        \"category\": \"Europe\"\n      }, {\n        \"id\": 5,\n        \"itemName\": \"South Korea\",\n        \"category\": \"asia\"\n      }, {\n        \"id\": 6,\n        \"itemName\": \"Sweden\",\n        \"category\": \"Europe\"\n      }];\n      this.selectedItems = [{\n        \"id\": 1,\n        \"itemName\": \"India\"\n      }, {\n        \"id\": 2,\n        \"itemName\": \"Singapore\"\n      }, {\n        \"id\": 4,\n        \"itemName\": \"Canada\"\n      }];\n      this.settings = {\n        singleSelection: false,\n        text: \"Select Fields\",\n        selectAllText: 'Select All',\n        unSelectAllText: 'UnSelect All',\n        searchPlaceholderText: 'Search Fields',\n        enableSearchFilter: true,\n        badgeShowLimit: 3,\n        groupBy: \"category\"\n      };\n    }\n    clearAll() {\n      this.nodes.forEach(node => {\n        this.removeNode(node.id, false);\n      });\n    }\n    rebuildLinks() {\n      //remove all existing visible links\n      this.links = [];\n      //rebuild the links by traversing DFS\n      this.nodes.forEach(item => {\n        let tmp = this.dfsLinkSearch(item.id);\n        // //deactivate this if condition and only keep else if you want to keep single type association intact irrespective of visibility of other node types whose no node is selected\n        // if(tmp.length==0){\n        //   this.links = this.links\n        // }\n        //else{\n        tmp.forEach(arr => {\n          if (arr.length > 0) {\n            let fwdkey = arr.pop();\n            console.log(item.id, fwdkey, arr);\n            this.addLinkForGraph(item.id, fwdkey, arr);\n          }\n        });\n        //}\n      });\n      this.update();\n    }\n    dfsLinkSearch(id) {\n      let currNode = this.masterMap[id];\n      let outputlinks = [];\n      let retlinks;\n      let tmp;\n      currNode.forwardnodes.forEach(fwdid => {\n        if (this.nodeTypeVisibilityMap[this.commons.getNodeTypeById(fwdid)] == false) {\n          retlinks = this.dfsLinkSearch(fwdid);\n          if (retlinks.length > 0) {\n            retlinks.forEach(retlinkarr => {\n              tmp = [];\n              tmp.push(fwdid);\n              retlinkarr.forEach(element => {\n                tmp.push(element);\n              });\n              outputlinks.push(tmp);\n            });\n          }\n        } else if (this.nodeIdMap[fwdid]) {\n          outputlinks.push([fwdid]);\n        }\n      });\n      return outputlinks;\n    }\n    showNodeType(type) {\n      this.nodeTypeVisibilityMap[type] = true;\n      //find nodes of this type which were previously visible\n      let nodesToShowAgain = [];\n      for (let key in this.nodeIdMap) {\n        if (this.nodeIdMap[key] && this.commons.getNodeTypeById(key) == type) {\n          nodesToShowAgain.push(key);\n          this.nodeIdMap[key] = false;\n        }\n      }\n      /*\r\n      //amongst existing visible links, break and make new links where intermediate contains one of the above nodes\r\n      let oldLinks = []\r\n      this.links.forEach(lnk=>{oldLinks.push(lnk)})\r\n      let newLinks = []\r\n            for(let i = 0; i < oldLinks.length; i++){\r\n        let lnk = oldLinks[i]\r\n        let broken = false;\r\n        if(lnk.intermediate.length>0){\r\n          let originalsource;\r\n          let origlen;\r\n          let point;\r\n          let right;\r\n          let left;\r\n          let originaltarget;\r\n          for (let index = 0; index < lnk.intermediate.length; index++) {\r\n            if(nodesToShowAgain.indexOf(lnk.intermediate[index])!=-1){\r\n              originalsource = lnk.source;\r\n              origlen = lnk.intermediate.length;\r\n              point = lnk.intermediate[index]\r\n              right = lnk.intermediate.splice(index+1,origlen)\r\n              left = lnk.intermediate.splice(0,index)\r\n              originaltarget = lnk.target;\r\n                    broken = true;\r\n              break;\r\n            }\r\n          }\r\n          if(broken){\r\n            oldLinks.push({source:lnk.source,target:point,intermediate:left})\r\n            oldLinks.push({source:point,target:originaltarget,intermediate:right})\r\n            oldLinks.splice(i,1)\r\n            i--;\r\n          }\r\n          else{\r\n            newLinks.push({source:lnk.source,target:lnk.target,intermediate:lnk.intermediate})\r\n          }\r\n        }\r\n        else{\r\n          newLinks.push({source:lnk.source,target:lnk.target,intermediate:lnk.intermediate})\r\n        }\r\n      }\r\n      console.log('New Link Set will be ',newLinks)\r\n      */\n      nodesToShowAgain.forEach(key => {\n        this.addNodeForGraph(key, false, true);\n      });\n      this.rebuildLinks();\n      /*this.links = newLinks;\r\n      this.update();*/\n      /*\r\n      this.links = []\r\n      newLinks.forEach(item=>{\r\n        this.addLinkForGraph(item.source,item.target,item.intermediate)\r\n      })\r\n      */\n    }\n    hideNodeType(type) {\n      this.nodeTypeVisibilityMap[type] = false;\n      //first remove all nodes of this type and their links from graph\n      let nodesToHide = this.nodes.filter(item => {\n        return this.commons.getNodeTypeById(item.id) == type;\n      });\n      nodesToHide.forEach(item => {\n        this.removeNode(item.id, true);\n      });\n      this.rebuildLinks();\n      // for(let key in this.masterMap){\n      //   if(this.nodeIdMap[key]&&this.nodeTypeVisibilityMap[this.commons.getNodeTypeById(key)]){\n      //     let tmp = this.rebuildLinks(key);\n      //     if(tmp.length>0){\n      //       let fwdkey = tmp.pop()\n      //       console.log(key,fwdkey,tmp)\n      //       this.addLinkForGraph(key,fwdkey,tmp)\n      //     }\n      //   }\n      // }\n      //////////////////////////////////////////////////////////////////\n      /*\r\n      //first remove all nodes of this type and their links from graph\r\n      let nodesToHide = this.nodes.filter((item)=>{\r\n        return this.commons.getNodeTypeById(item.id)==type;\r\n      })\r\n      nodesToHide.forEach(item=>{\r\n        this.removeNode(item.id, true)\r\n      })\r\n      \r\n      this.nodes.forEach(node=>{\r\n        //for all remaining nodes\r\n        //bfs untill node of visible type found\r\n            })*/\n      /////////////////////////////////////////////////////////////////////\n      // //have a list of currently visible nodes of this type\n      // let nodesToHide = this.nodes.filter((item)=>{\n      //   return this.commons.getNodeTypeById(item.id)==type;\n      // })\n      // let newLinks = []\n      // //now it is time to link it's visible fwd to visible bwd\n      // ///*nodesToHide.forEach(item=>{\n      // //  item.forwardnodes.forEach(fwdnode=>{\n      // //    if(this.nodeIdMap[fwdnode]){\n      // //      item.backwardnodes.forEach(bwdnode=>{\n      // //        if(this.nodeIdMap[bwdnode]){\n      // //          \n      // //        }\n      // //      })\n      // //    }\n      // //  })\n      // //})*/\n      // nodesToHide.forEach(item=>{\n      //   let fwdLinks = this.links.filter(lnk=>{return lnk.source.id==item.id})\n      //   let bwdLinks = this.links.filter(lnk=>{return lnk.target.id==item.id})\n      //   let fwdNodes = []\n      //   let bwdNodes = []\n      //   fwdLinks.forEach(lnk=>{\n      //     fwdNodes.push({id:lnk.target.id,intermediate:lnk.intermediate})\n      //   })\n      //   bwdLinks.forEach(lnk=>{\n      //     bwdNodes.push({id:lnk.source.id,intermediate:lnk.intermediate})\n      //   })\n      //   let tmp = []\n      //   bwdNodes.forEach(bwd=>{\n      //     tmp = []\n      //     bwd.intermediate.forEach(i=>{tmp.push(i)})\n      //     tmp.push(item.id)\n      //     fwdNodes.forEach(fwd=>{\n      //       fwd.intermediate.forEach(i=>{tmp.push(i)})\n      //       newLinks.push({source:bwd.id,target:fwd.id,intermediate:tmp.filter(j=>{return true})})\n      //     })\n      //   })\n      // })\n      // console.log(newLinks)\n      // //hide those nodes and links if any\n      // nodesToHide.forEach(item=>{\n      //   this.removeNode(item.id,true)\n      // })\n      // newLinks.forEach(item=>{\n      //   this.addLinkForGraph(item.source,item.target,item.intermediate)\n      // })\n    }\n    toggleNodeVisibility(type) {\n      if (this.nodeTypeVisibilityMap[type]) {\n        this.hideNodeType(type);\n      } else {\n        this.showNodeType(type);\n      }\n    }\n    getNodeColor(type) {\n      return this.nodeColorMap[type] ? this.nodeColorMap[type] : this.defaultNodeColor;\n    }\n    getNodeSize(type) {\n      return this.nodeSizeMap[type] ? this.nodeSizeMap[type] : this.defaultNodeSize;\n    }\n    openDialog(obj, masterMap) {\n      this.dialog.open(DialogComponentComponent, {\n        // height: '80%',\n        // width: '80%',\n        data: {\n          node: obj,\n          nodeMap: masterMap\n        }\n      });\n    }\n    removeNode(id, keepInMap) {\n      if (!keepInMap) {\n        this.nodeIdMap[id] = false;\n      }\n      if (this.selectedNodeId == id) {\n        this.setSelectedNodeId(\"\");\n      }\n      this.nodes = this.nodes.filter(function (item) {\n        return item.id != id;\n      });\n      this.links = this.links.filter(function (item) {\n        return (item.source.id ? item.source.id != id : item.source != id) && (item.target.id ? item.target.id != id : item.target != id);\n      });\n      this.update();\n    }\n    addAllForwardNodes(id, recursive) {\n      if (!recursive) {\n        this.getNodeById(id).forwardnodes.forEach(childid => {\n          this.addNodeForGraph(childid, false);\n        });\n      } else {\n        let stack = [id];\n        let processed = [];\n        let currentId;\n        while (stack.length > 0) {\n          currentId = stack.shift();\n          if (processed.indexOf(currentId) == -1) {\n            this.getNodeById(currentId).forwardnodes.forEach(childid => stack.push(childid));\n            this.addNodeForGraph(currentId, false);\n            processed.push(currentId);\n          }\n        }\n      }\n    }\n    addAllBackwardNodes(id, recursive) {\n      if (!recursive) {\n        this.getNodeById(id).backwardnodes.forEach(childid => {\n          this.addNodeForGraph(childid, false);\n        });\n      } else {\n        let stack = [id];\n        let processed = [];\n        let currentId;\n        while (stack.length > 0) {\n          currentId = stack.shift();\n          if (processed.indexOf(currentId) == -1) {\n            this.getNodeById(currentId).backwardnodes.forEach(childid => stack.push(childid));\n            this.addNodeForGraph(currentId, false);\n            processed.push(currentId);\n          }\n        }\n      }\n    }\n    getNodeById(id) {\n      if (this.commons.getNodeTypeById(id) == \"system\") {\n        return this.systemsMap[id];\n      } else if (this.commons.getNodeTypeById(id) == \"feed\") {\n        return this.feedsMap[id];\n      } else if (this.commons.getNodeTypeById(id) == \"table\") {\n        return this.tablesMap[id];\n      } else if (this.commons.getNodeTypeById(id) == \"operation\") {\n        return this.operationsMap[id];\n      } else if (this.commons.getNodeTypeById(id) == \"view\") {\n        return this.viewsMap[id];\n      }\n    }\n    addNodeForGraph(id, select = true, skiplink = false) {\n      if (this.nodeTypeVisibilityMap[this.commons.getNodeTypeById(id)]) {\n        if (select) {\n          this.setSelectedNodeId(id);\n        }\n        if (!this.nodeIdMap[id]) {\n          let obj = this.getNodeById(id);\n          let node = {\n            id: obj.id,\n            name: obj.name,\n            label: this.commons.getNodeTypeById(id)\n          };\n          this.nodeIdMap[obj.id] = true;\n          this.nodes.push(node);\n          console.log(node.id, node.name, node.label);\n          this.update();\n          if (!skiplink) {\n            /*obj.forwardnodes.forEach(fwdid => {\r\n              if (this.nodeIdMap[fwdid]) this.addLinkForGraph(obj.id, fwdid, []);\r\n            });\r\n            obj.backwardnodes.forEach(bwdid => {\r\n              if (this.nodeIdMap[bwdid]) this.addLinkForGraph(bwdid, obj.id, []);\r\n            });\r\n            console.warn(this.linkCount)*/\n            this.rebuildLinks();\n          }\n        }\n      }\n    }\n    addLinkForGraph(fromId, toId, intermediate) {\n      this.linkCount++;\n      let fromtype = this.commons.getNodeTypeById(fromId);\n      let totype = this.commons.getNodeTypeById(toId);\n      let linktype = \"\";\n      if (fromtype == \"system\" && totype == \"feed\") {\n        linktype = \"exports\";\n      } else if (fromtype == \"feed\" && totype == \"operation\") {\n        linktype = \"consumed\";\n      } else if (fromtype == \"table\" && totype == \"operation\") {\n        linktype = \"referenced\";\n      } else if (fromtype == \"operation\" && totype == \"table\") {\n        linktype = \"outputs\";\n      } else if (fromtype == \"table\" && totype == \"view\") {\n        linktype = \"referenced\";\n      } else if (fromtype == \"operation\" && totype == \"feed\") {\n        linktype = \"exports\";\n      } else if (fromtype == \"feed\" && totype == \"system\") {\n        linktype = \"consumed\";\n      }\n      console.log(fromId, toId, linktype);\n      this.links.push({\n        source: fromId,\n        target: toId,\n        type: linktype,\n        intermediate: intermediate\n      });\n      this.update();\n    }\n    addLineage(fromId, toId) {\n      this.getNodeById(fromId).forwardnodes.push(toId);\n      this.getNodeById(toId).backwardnodes.push(fromId);\n    }\n    initApp() {\n      this.systems.forEach(system => {\n        this.systemsMap[system.id] = system;\n        system[\"forwardnodes\"] = [];\n        system[\"backwardnodes\"] = [];\n        this.nodeIdMap[system.id] = false;\n        this.masterMap[system.id] = system;\n        if (system.id == this.currentSystem) {\n          system[\"disabled\"] = true;\n        }\n      });\n      this.tables.forEach(table => {\n        this.tablesMap[table.id] = table;\n        table[\"forwardnodes\"] = [];\n        table[\"backwardnodes\"] = [];\n        this.nodeIdMap[table.id] = false;\n        this.masterMap[table.id] = table;\n      });\n      this.views.forEach(view => {\n        this.viewsMap[view.id] = view;\n        view[\"forwardnodes\"] = [];\n        view[\"backwardnodes\"] = [];\n        this.nodeIdMap[view.id] = false;\n        this.masterMap[view.id] = view;\n        view.tblviewref.forEach(tblref => {\n          this.addLineage(tblref, view.id);\n        });\n      });\n      this.feeds.forEach(feed => {\n        this.feedsMap[feed.id] = feed;\n        feed[\"forwardnodes\"] = [];\n        feed[\"backwardnodes\"] = [];\n        if (feed.direction == \"inbound\") {\n          this.addLineage(feed.gensysref, feed.id);\n        }\n        if (feed.direction == \"outbound\") {\n          feed.consysref.forEach(sysref => {\n            this.addLineage(feed.id, sysref);\n          });\n        }\n        this.nodeIdMap[feed.id] = false;\n        this.masterMap[feed.id] = feed;\n      });\n      this.operations.forEach(operation => {\n        this.operationsMap[operation.id] = operation;\n        operation[\"forwardnodes\"] = [];\n        operation[\"backwardnodes\"] = [];\n        if (operation.type == \"Ingestion\") {\n          //feedref\n          this.addLineage(operation.feedref, operation.id);\n          //tblviewref loop\n          operation.tblviewref.forEach(ref => {\n            this.addLineage(ref, operation.id);\n          });\n          //outputtblref\n          this.addLineage(operation.id, operation.outputtblref);\n        } else if (operation.type == \"Transformation\") {\n          //tblviewref loop\n          operation.tblviewref.forEach(ref => {\n            this.addLineage(ref, operation.id);\n          });\n          //outputtblref\n          this.addLineage(operation.id, operation.outputtblref);\n        } else if (operation.type == \"Extraction\") {\n          //tblviewref\n          operation.tblviewref.forEach(ref => {\n            this.addLineage(ref, operation.id);\n          });\n          //outputfeedref\n          this.addLineage(operation.id, operation.outputfeedref);\n          //outputtblref (Optional)\n          if (operation.outputtblref) {\n            this.addLineage(operation.id, operation.outputtblref);\n          }\n        }\n        this.nodeIdMap[operation.id] = false;\n        this.masterMap[operation.id] = operation;\n      });\n      console.log(this.nodeIdMap, this.systemsMap, this.feedsMap, this.tablesMap, this.viewsMap, this.operationsMap);\n      console.log(this.nodeIdMap);\n    }\n    resetZoom() {\n      this.svg.transition().duration(750).call(this.zoom_handler.transform, d3.zoomIdentity);\n    }\n    zoom_actions(e) {\n      this.svgcontainer.attr(\"transform\", e.transform);\n    }\n    // zoomed(e,d) {\n    //   this.svg.attr(\"transform\", e.transform);\n    // }\n    ngAfterViewInit() {\n      this.width = this.hostElement.nativeElement.offsetParent.offsetWidth;\n      console.log(this.width);\n      console.log(this.height);\n      this.simulation = d3.forceSimulation().force(\"link\", d3.forceLink().id(function (d) {\n        return d[\"id\"];\n      }).distance(150).strength(1)).force(\"charge\", d3.forceManyBody()).force(\"center\", d3.forceCenter(this.width / 2, this.height / 2)).on(\"tick\", () => this.ticked());\n    }\n    ngAfterContentInit() {\n      this.svg = d3.select(\"svg\");\n      this.zoom_handler(this.svg);\n      this.svg\n      //.call(d3.zoom()\n      //.scaleExtent([0.1, 4])\n      // .on(\"zoom\", (e,d)=>this.zoomed(e,d))\n      // )\n      .append(\"defs\").append(\"marker\").attr(\"id\", \"arrowhead\").attr(\"viewBox\", \"-0 -5 10 10\").attr(\"refX\", d => {\n        console.log(d);\n        return 20;\n      }).attr(\"refY\", 0).attr(\"orient\", \"auto\").attr(\"markerWidth\", 13).attr(\"markerHeight\", 13).attr(\"xoverflow\", \"visible\").append(\"svg:path\").attr(\"d\", \"M 0,-5 L 10 ,0 L 0,5\").attr(\"fill\", \"#999\").style(\"stroke\", \"none\");\n      this.svgcontainer = this.svg.append(\"g\");\n      //this.width = +this.svg.attr(\"width\");\n      this.height = +this.svg.attr(\"height\");\n      this.drag = d3.drag().on(\"start\", (e, d) => this.dragstarted(e, d)).on(\"drag\", (e, d) => this.dragged(e, d)).on(\"end\", (e, d) => this.dragended(e, d));\n      //this.update();\n      this.initApp();\n    }\n    update() {\n      this.simulation.force(\"link\").links(this.links);\n      this.simulation.nodes(this.nodes);\n      console.log(\"update\");\n      this.link = this.svgcontainer.selectAll(\".link\").data(this.links, function (d) {\n        return d.target.id;\n      });\n      let linkEnter = this.link.enter().append(\"line\").attr(\"class\", \"link\").attr(\"marker-end\", \"url(#arrowhead)\");\n      this.link.exit().remove();\n      this.node = this.svgcontainer.selectAll(\".node\").data(this.nodes, function (d) {\n        return d.id;\n      });\n      let nodeEnter = this.node.enter().append(\"g\").attr(\"class\", \"node\").on(\"click\", (e, d) => this.click(e, d)).on(\"contextmenu\", (e, d) => {\n        e.preventDefault();\n        this.removeNode(d.id, false);\n        // react on right-clicking\n      }).call(this.drag);\n      this.node.exit().remove();\n      this.node = nodeEnter.merge(this.node);\n      this.link = linkEnter.merge(this.link);\n      nodeEnter.append(\"circle\").attr(\"r\", (d, i) => {\n        return this.getNodeSize(this.commons.getNodeTypeById(d.id));\n      }).style(\"fill\", (d, i) => {\n        return this.getNodeColor(this.commons.getNodeTypeById(d.id));\n      }).style(\"stroke\", \"gray\").style(\"stroke-width\", \"1px\").style(\"opacity\", \"0.3\");\n      nodeEnter.append('text').attr('text-anchor', 'middle').attr('dominant-baseline', 'central').attr('font-size', (d, i) => {\n        return \"\" + parseInt(\"\" + this.getNodeSize(this.commons.getNodeTypeById(d.id)) * 1.5);\n      }).text(d => {\n        return this.nodeIconMap[this.commons.getNodeTypeById(d.id)];\n      });\n      nodeEnter.append(\"title\").text(function (d) {\n        return 'Click for the details\\nID: ' + d.id;\n      });\n      nodeEnter.append(\"text\").attr(\"dy\", d => {\n        return this.getNodeSize(this.commons.getNodeTypeById(d.id)) + 8;\n      }).attr(\"dx\", d => {\n        return this.getNodeSize(this.commons.getNodeTypeById(d.id)) + 4;\n      }).text(function (d) {\n        return d.name;\n      }).style('font-weight', '400');\n      this.simulation.alpha(1).restart();\n    }\n    click(e, d) {\n      /*let target = { id: this.index, name: \"server \" + this.index };\r\n      this.nodes.push(target);\r\n      this.links.push({ source: d, target: target });\r\n      this.index++;\r\n      this.update();*/\n      this.setSelectedNodeId(d.id);\n    }\n    ticked() {\n      console.log(\"ticked\");\n      if (this.link) this.link.attr(\"x1\", function (d) {\n        return d.source.x;\n      }).attr(\"y1\", function (d) {\n        return d.source.y;\n      }).attr(\"x2\", function (d) {\n        return d.target.x;\n      }).attr(\"y2\", function (d) {\n        return d.target.y;\n      });\n      if (this.node) this.node.attr(\"transform\", function (d) {\n        return \"translate(\" + d.x + \", \" + d.y + \")\";\n      });\n    }\n    dragstarted(e, d) {\n      if (!e.active) this.simulation.alphaTarget(0.3).restart();\n    }\n    dragged(e, d) {\n      console.log(arguments);\n      d.fx = e.x;\n      d.fy = e.y;\n    }\n    dragended(e, d) {\n      console.log(arguments);\n      if (!e.active) this.simulation.alphaTarget(0);\n      d.fx = undefined;\n      d.fy = undefined;\n    }\n  }\n  AppComponent.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i1.CommonsService), i0.ɵɵdirectiveInject(i2.MatDialog), i0.ɵɵdirectiveInject(i3.MatSnackBar));\n  };\n  AppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"app-root\"]],\n    viewQuery: function AppComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.svgElement = _t.first);\n      }\n    },\n    decls: 16,\n    vars: 8,\n    consts: [[3, \"masterMap\", \"nodeIdMap\", \"nodeTypeVisibilityMap\", \"updateSelection\"], [4, \"ngIf\"], [2, \"position\", \"relative\"], [\"matTooltip\", \"Reset zoom level and recenter graph\", \"mat-button\", \"\", 1, \"resetZoomButton\", 3, \"click\"], [\"matTooltip\", \"Remove all visible nodes in graph\", \"mat-button\", \"\", \"class\", \"clearAllButton\", 3, \"click\", 4, \"ngIf\"], [\"height\", \"600\", 2, \"width\", \"99%\", \"margin\", \"2px\"], [\"svgElement\", \"\"], [2, \"display\", \"flex\", \"position\", \"absolute\", \"flex-direction\", \"row\", \"top\", \"0px\", \"right\", \"11px\", \"margin-top\", \"2px\", \"margin-left\", \"3px\", \"font-weight\", \"500\"], [\"style\", \"border-bottom: 1px solid gray;border-left: 1px solid gray;padding: 8px;\", 4, \"ngFor\", \"ngForOf\"], [2, \"align-items\", \"center\", \"align-content\", \"center\", \"align-self\", \"center\", \"justify-content\", \"center\", \"justify-items\", \"center\", \"display\", \"flex\"], [2, \"display\", \"flex\", \"align-items\", \"flex-start\", \"padding-top\", \"16px\", \"padding-bottom\", \"16px\"], [2, \"display\", \"contents\", 3, \"ngStyle\"], [\"matTooltip\", \"Add all backward lineage nodes recursively till source\", \"mat-button\", \"\", 2, \"border\", \"1px solid gray\", \"margin-top\", \"-8px\", 3, \"click\"], [2, \"width\", \"120px\", \"border-bottom\", \"1px solid black\", \"margin-top\", \"-13px\", \"padding-bottom\", \"4px\", \"font-size\", \"0.9em\", \"color\", \"gray\"], [\"matTooltip\", \"Add all previous level backward lineage nodes\", \"mat-button\", \"\", 2, \"border\", \"1px solid gray\", \"margin-top\", \"-8px\", 3, \"click\"], [2, \"position\", \"relative\", \"display\", \"grid\"], [2, \"border-bottom\", \"1px solid black\", \"margin-top\", \"-13px\", \"padding-bottom\", \"4px\", \"font-size\", \"0.9em\", \"color\", \"gray\", \"width\", \"100%\"], [2, \"text-align\", \"left\", \"padding\", \"12px\", 3, \"ngClass\"], [3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [2, \"margin\", \"0 8px 0 8px\"], [\"matTooltip\", \"Know more about this node\", 2, \"cursor\", \"pointer\", \"margin-right\", \"6px\", 3, \"click\"], [\"matTooltip\", \"Add all next level forward lineage nodes\", \"mat-button\", \"\", 2, \"border\", \"1px solid gray\", \"margin-top\", \"-8px\", 3, \"click\"], [2, \"width\", \"120px\", \"border-bottom\", \"1px solid black\", \"margin-top\", \"-13px\", \"padding-bottom\", \"4px\", \"font-size\", \"0.9em\", \"color\", \"gray\", \"text-align\", \"right\"], [\"matTooltip\", \"Add all forward lineage nodes recursively till destination\", \"mat-button\", \"\", 2, \"border\", \"1px solid gray\", \"margin-top\", \"-8px\", 3, \"click\"], [3, \"ngClass\"], [2, \"cursor\", \"pointer\", \"margin-right\", \"8px\", \"border\", \"1px solid gray\", 3, \"matTooltip\", \"ngStyle\", \"click\"], [2, \"cursor\", \"pointer\", 3, \"click\"], [\"matTooltip\", \"Remove all visible nodes in graph\", \"mat-button\", \"\", 1, \"clearAllButton\", 3, \"click\"], [2, \"border-bottom\", \"1px solid gray\", \"border-left\", \"1px solid gray\", \"padding\", \"8px\"], [2, \"font-size\", \"large\"], [2, \"margin-left\", \"8px\", 3, \"matTooltip\", \"color\", \"checked\", \"change\"]],\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"mat-toolbar\")(1, \"span\");\n        i0.ɵɵtext(2, \"Data Lineage Tool\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(3, \"app-dropdown\", 0);\n        i0.ɵɵlistener(\"updateSelection\", function AppComponent_Template_app_dropdown_updateSelection_3_listener($event) {\n          return ctx.nodeSelectionUpdate($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(4, \"mat-divider\");\n        i0.ɵɵtemplate(5, AppComponent_div_5_Template, 32, 18, \"div\", 1);\n        i0.ɵɵelement(6, \"mat-divider\");\n        i0.ɵɵelementStart(7, \"div\", 2)(8, \"button\", 3);\n        i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_8_listener() {\n          return ctx.resetZoom();\n        });\n        i0.ɵɵtext(9, \"Reset Zoom\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(10, AppComponent_button_10_Template, 2, 0, \"button\", 4);\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelement(11, \"svg\", 5, 6);\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(13, \"div\", 7);\n        i0.ɵɵtemplate(14, AppComponent_div_14_Template, 10, 10, \"div\", 8);\n        i0.ɵɵpipe(15, \"keyvalue\");\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"masterMap\", ctx.masterMap)(\"nodeIdMap\", ctx.nodeIdMap)(\"nodeTypeVisibilityMap\", ctx.nodeTypeVisibilityMap);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedNodeId.length > 0);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.nodes.length > 0);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(15, 6, ctx.nodeIconMap));\n      }\n    },\n    dependencies: [i4.NgClass, i4.NgForOf, i4.NgIf, i4.NgStyle, i5.MatToolbar, i6.MatIcon, i7.MatSlideToggle, i8.MatTooltip, i9.MatDivider, i10.MatButton, i11.DefaultClassDirective, i11.DefaultStyleDirective, i12.DropdownComponent, i4.TitleCasePipe, i4.KeyValuePipe],\n    styles: [\".link{stroke:#999;cursor:default}  .node{pointer-events:all;stroke:none;stroke-width:40px;cursor:pointer}svg[_ngcontent-%COMP%]{border:1px solid gray;cursor:all-scroll}.showHide[_ngcontent-%COMP%]{height:24px;width:24px;vertical-align:middle;cursor:pointer}.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed;opacity:.2}.pointer[_ngcontent-%COMP%]{cursor:pointer}.invisible[_ngcontent-%COMP%]{visibility:hidden}.resetZoomButton[_ngcontent-%COMP%]{position:absolute;z-index:15;left:4px;top:4px;float:left}.clearAllButton[_ngcontent-%COMP%]{position:absolute;z-index:15;left:4px;top:36px;float:left}\"]\n  });\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}